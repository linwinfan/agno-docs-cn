---
title: è¿è¡Œæ™ºèƒ½ä½“
sidebarTitle: è¿è¡Œæ™ºèƒ½ä½“
description: å­¦ä¹ å¦‚ä½•è¿è¡Œæ‚¨çš„æ™ºèƒ½ä½“å¹¶å¤„ç†å®ƒä»¬çš„è¾“å‡ºã€‚
---

é€šè¿‡è°ƒç”¨ `Agent.run()` æˆ– `Agent.arun()` æ¥è¿è¡Œæ‚¨çš„æ™ºèƒ½ä½“ã€‚å®ƒä»¬çš„å·¥ä½œæ–¹å¼å¦‚ä¸‹ï¼š

1. æ™ºèƒ½ä½“æ„å»ºè¦å‘é€ç»™æ¨¡å‹çš„ä¸Šä¸‹æ–‡ï¼ˆç³»ç»Ÿæ¶ˆæ¯ã€ç”¨æˆ·æ¶ˆæ¯ã€èŠå¤©å†å²ã€ç”¨æˆ·è®°å¿†ã€ä¼šè¯çŠ¶æ€å’Œå…¶ä»–ç›¸å…³è¾“å…¥ï¼‰ã€‚
2. æ™ºèƒ½ä½“å°†æ­¤ä¸Šä¸‹æ–‡å‘é€ç»™æ¨¡å‹ã€‚
3. æ¨¡å‹å¤„ç†è¾“å…¥å¹¶å“åº”æ¶ˆæ¯æˆ–å·¥å…·è°ƒç”¨ã€‚
4. å¦‚æœæ¨¡å‹è¿›è¡Œå·¥å…·è°ƒç”¨ï¼Œæ™ºèƒ½ä½“æ‰§è¡Œå®ƒå¹¶å°†ç»“æœè¿”å›ç»™æ¨¡å‹ã€‚
5. æ¨¡å‹å¤„ç†æ›´æ–°çš„ä¸Šä¸‹æ–‡ï¼Œé‡å¤æ­¤å¾ªç¯ç›´åˆ°äº§ç”Ÿæ²¡æœ‰ä»»ä½•å·¥å…·è°ƒç”¨çš„æœ€ç»ˆæ¶ˆæ¯ã€‚
6. æ™ºèƒ½ä½“å°†æ­¤æœ€ç»ˆå“åº”è¿”å›ç»™è°ƒç”¨è€…ã€‚

## åŸºæœ¬æ‰§è¡Œ

`Agent.run()` å‡½æ•°è¿è¡Œæ™ºèƒ½ä½“å¹¶è¿”å›è¾“å‡ºâ€”â€”è¦ä¹ˆä½œä¸º `RunOutput` å¯¹è±¡ï¼Œè¦ä¹ˆä½œä¸º `RunOutputEvent` å¯¹è±¡æµï¼ˆå½“ `stream=True` æ—¶ï¼‰ã€‚ä¾‹å¦‚ï¼š

```python
from agno.agent import Agent, RunOutput
from agno.models.anthropic import Claude
from agno.tools.hackernews import HackerNewsTools
from agno.utils.pprint import pprint_run_response

agent = Agent(
    model=Claude(id="claude-sonnet-4-5"),
    tools=[HackerNewsTools()],
    instructions="å°±è¯¥ä¸»é¢˜å†™ä¸€ä»½æŠ¥å‘Šã€‚åªè¾“å‡ºæŠ¥å‘Šã€‚",
    markdown=True,
)

# è¿è¡Œæ™ºèƒ½ä½“å¹¶å°†å“åº”ä½œä¸ºå˜é‡è¿”å›
response: RunOutput = agent.run("è¶‹åŠ¿åˆåˆ›å…¬å¸å’Œäº§å“ã€‚")

# ä»¥ markdown æ ¼å¼æ‰“å°å“åº”
pprint_run_response(response, markdown=True)
```

<Tip>
æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨ `Agent.arun()` å¼‚æ­¥è¿è¡Œæ™ºèƒ½ä½“ã€‚è¯·å‚é˜…æ­¤[ç¤ºä¾‹](/basics/agents/usage/basic-async)ã€‚
</Tip>

## è¿è¡Œè¾“å…¥

`input` å‚æ•°æ˜¯è¦å‘é€ç»™æ™ºèƒ½ä½“çš„è¾“å…¥ã€‚å®ƒå¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€åˆ—è¡¨ã€å­—å…¸ã€æ¶ˆæ¯ã€pydantic æ¨¡å‹æˆ–æ¶ˆæ¯åˆ—è¡¨ã€‚ä¾‹å¦‚ï¼š

```python
# å­—ç¬¦ä¸²è¾“å…¥
agent.run("Hello, how are you?")

# åˆ—è¡¨è¾“å…¥
agent.run(["Hello", "how are you?"])

# å­—å…¸è¾“å…¥
agent.run({"message": "Hello, how are you?"})

# æ¶ˆæ¯è¾“å…¥
from agno.agent import Agent
from agno.models.message import Message

message = Message(
    role="user",
    content="Hello, how are you?"
)
agent.run(message)

# Pydantic æ¨¡å‹è¾“å…¥
from pydantic import BaseModel

class UserInput(BaseModel):
    message: str

input_data = UserInput(message="Hello, how are you?")
agent.run(input_data)

# æ¶ˆæ¯åˆ—è¡¨è¾“å…¥
messages = [
    Message(role="user", content="Hello"),
    Message(role="assistant", content="Hi there!"),
    Message(role="user", content="How are you?")
]
agent.run(messages)
```

## è¿è¡Œè¾“å‡º

`Agent.run()` è¿”å›ä¸€ä¸ª `RunOutput` å¯¹è±¡ï¼ŒåŒ…å«æ™ºèƒ½ä½“çš„å“åº”ã€‚`RunOutput` å¯¹è±¡å…·æœ‰ä»¥ä¸‹å±æ€§ï¼š

```python
from agno.agent import Agent, RunOutput
from agno.models.anthropic import Claude
from agno.tools.hackernews import HackerNewsTools

agent = Agent(
    model=Claude(id="claude-sonnet-4-5"),
    tools=[HackerNewsTools()],
    instructions="å°±è¯¥ä¸»é¢˜å†™ä¸€ä»½æŠ¥å‘Šã€‚åªè¾“å‡ºæŠ¥å‘Šã€‚",
    markdown=True,
)

response: RunOutput = agent.run("è¶‹åŠ¿åˆåˆ›å…¬å¸å’Œäº§å“ã€‚")

# è®¿é—®å“åº”å†…å®¹
print(response.content)

# è®¿é—®è¿è¡ŒçŠ¶æ€
print(response.run_id)
print(response.agent_id)
print(response.session_id)
print(response.user_id)

# è®¿é—®å·¥å…·è°ƒç”¨
print(response.tools)

# è®¿é—®æŒ‡æ ‡
print(response.metrics)

# è®¿é—®ä¼šè¯çŠ¶æ€
print(response.session_state)
```

## æµå¼ä¼ è¾“

æ‚¨å¯ä»¥é€šè¿‡è®¾ç½® `stream=True` æ¥æµå¼ä¼ è¾“æ™ºèƒ½ä½“çš„å“åº”ã€‚è¿™å¯¹äºèŠå¤©åº”ç”¨ç¨‹åºå’Œå®æ—¶åé¦ˆå¾ˆæœ‰ç”¨ã€‚

```python
from agno.agent import Agent
from agno.models.anthropic import Claude
from agno.tools.hackernews import HackerNewsTools

agent = Agent(
    model=Claude(id="claude-sonnet-4-5"),
    tools=[HackerNewsTools()],
    instructions="å°±è¯¥ä¸»é¢˜å†™ä¸€ä»½æŠ¥å‘Šã€‚åªè¾“å‡ºæŠ¥å‘Šã€‚",
    markdown=True,
)

# æµå¼ä¼ è¾“å“åº”
stream = agent.run("è¶‹åŠ¿åˆåˆ›å…¬å¸å’Œäº§å“ã€‚", stream=True)

for chunk in stream:
    if chunk.event == "content":
        print(chunk.content, end="")
```

## æµå¼ä¼ è¾“å†…éƒ¨äº‹ä»¶

å½“æµå¼ä¼ è¾“æ—¶ï¼Œæ™ºèƒ½ä½“ä¼šå‘å‡ºå„ç§äº‹ä»¶ï¼Œè®©æ‚¨èƒ½å¤Ÿå®æ—¶ç›‘æ§æ‰§è¡Œè¿‡ç¨‹ã€‚

```python
from agno.agent import Agent, RunEvent
from agno.models.anthropic import Claude
from agno.tools.hackernews import HackerNewsTools

agent = Agent(
    model=Claude(id="claude-sonnet-4-5"),
    tools=[HackerNewsTools()],
    instructions="å°±è¯¥ä¸»é¢˜å†™ä¸€ä»½æŠ¥å‘Šã€‚åªè¾“å‡ºæŠ¥å‘Šã€‚",
    markdown=True,
)

stream = agent.run("è¶‹åŠ¿åˆåˆ›å…¬å¸å’Œäº§å“ã€‚", stream=True)

for chunk in stream:
    if chunk.event == RunEvent.run_started:
        print("æ™ºèƒ½ä½“å¼€å§‹è¿è¡Œ")
    elif chunk.event == RunEvent.run_content:
        print(chunk.content, end="")
    elif chunk.event == RunEvent.run_tool_call:
        print(f"è°ƒç”¨å·¥å…·: {chunk.tool_call.name}")
    elif chunk.event == RunEvent.run_tool_response:
        print(f"å·¥å…·å“åº”: {chunk.tool_response.result}")
    elif chunk.event == RunEvent.run_completed:
        print("æ™ºèƒ½ä½“è¿è¡Œå®Œæˆ")
```

## å¤„ç†äº‹ä»¶

æ‚¨å¯ä»¥ä½¿ç”¨ `RunEvent` æšä¸¾æ¥å¤„ç†ä¸åŒç±»å‹çš„äº‹ä»¶ï¼š

```python
from agno.agent import Agent, RunEvent
from agno.models.anthropic import Claude
from agno.tools.hackernews import HackerNewsTools

agent = Agent(
    model=Claude(id="claude-sonnet-4-5"),
    tools=[HackerNewsTools()],
    instructions="å°±è¯¥ä¸»é¢˜å†™ä¸€ä»½æŠ¥å‘Šã€‚åªè¾“å‡ºæŠ¥å‘Šã€‚",
    markdown=True,
)

stream = agent.run("è¶‹åŠ¿åˆåˆ›å…¬å¸å’Œäº§å“ã€‚", stream=True)

for chunk in stream:
    match chunk.event:
        case RunEvent.run_started:
            print("ğŸš€ æ™ºèƒ½ä½“å¼€å§‹è¿è¡Œ")
        case RunEvent.run_content:
            print(chunk.content, end="")
        case RunEvent.run_tool_call:
            print(f"ğŸ”§ è°ƒç”¨å·¥å…·: {chunk.tool_call.name}")
        case RunEvent.run_tool_response:
            print(f"ğŸ“‹ å·¥å…·å“åº”: {chunk.tool_response.result}")
        case RunEvent.run_completed:
            print("âœ… æ™ºèƒ½ä½“è¿è¡Œå®Œæˆ")
        case RunEvent.run_failed:
            print(f"âŒ æ™ºèƒ½ä½“è¿è¡Œå¤±è´¥: {chunk.error}")
        case _:
            print(f"ğŸ“ æœªçŸ¥äº‹ä»¶: {chunk.event}")
```

## äº‹ä»¶ç±»å‹

### run_started

å½“æ™ºèƒ½ä½“å¼€å§‹è¿è¡Œæ—¶å‘å‡ºã€‚

```python
{
    "event": "run_started",
    "run_id": "123",
    "agent_id": "123",
    "session_id": "123",
    "user_id": "123"
}
```

### run_content

å½“æ™ºèƒ½ä½“ç”Ÿæˆå†…å®¹æ—¶å‘å‡ºã€‚

```python
{
    "event": "run_content",
    "content": "Hello, world!"
}
```

### run_tool_call

å½“æ™ºèƒ½ä½“è°ƒç”¨å·¥å…·æ—¶å‘å‡ºã€‚

```python
{
    "event": "run_tool_call",
    "tool_call": {
        "name": "hackernews_top_stories",
        "arguments": {"limit": 5}
    }
}
```

### run_tool_response

å½“å·¥å…·è¿”å›å“åº”æ—¶å‘å‡ºã€‚

```python
{
    "event": "run_tool_response",
    "tool_response": {
        "name": "hackernews_top_stories",
        "result": [...]
    }
}
```

### run_completed

å½“æ™ºèƒ½ä½“å®Œæˆè¿è¡Œæ—¶å‘å‡ºã€‚

```python
{
    "event": "run_completed",
    "run_id": "123",
    "agent_id": "123",
    "session_id": "123",
    "user_id": "123"
}
```

### run_failed

å½“æ™ºèƒ½ä½“è¿è¡Œå¤±è´¥æ—¶å‘å‡ºã€‚

```python
{
    "event": "run_failed",
    "run_id": "123",
    "agent_id": "123",
    "session_id": "123",
    "user_id": "123",
    "error": "Something went wrong"
}
```

## è‡ªå®šä¹‰äº‹ä»¶

æ‚¨å¯ä»¥åˆ›å»ºè‡ªå®šä¹‰äº‹ä»¶æ¥æ‰©å±•æ™ºèƒ½ä½“çš„åŠŸèƒ½ï¼š

```python
from agno.agent import Agent, RunEvent
from agno.models.anthropic import Claude
from agno.tools.hackernews import HackerNewsTools

class CustomEvent(RunEvent):
    custom_event = "custom_event"

agent = Agent(
    model=Claude(id="claude-sonnet-4-5"),
    tools=[HackerNewsTools()],
    instructions="å°±è¯¥ä¸»é¢˜å†™ä¸€ä»½æŠ¥å‘Šã€‚åªè¾“å‡ºæŠ¥å‘Šã€‚",
    markdown=True,
)

# å‘å‡ºè‡ªå®šä¹‰äº‹ä»¶
agent.emit_event(CustomEvent(data="è‡ªå®šä¹‰æ•°æ®"))
```

## æŒ‡å®šè¿è¡Œç”¨æˆ·å’Œä¼šè¯

æ‚¨å¯ä»¥ä¸ºè¿è¡ŒæŒ‡å®šç”¨æˆ·å’Œä¼šè¯ï¼š

```python
from agno.agent import Agent
from agno.models.anthropic import Claude
from agno.tools.hackernews import HackerNewsTools

agent = Agent(
    model=Claude(id="claude-sonnet-4-5"),
    tools=[HackerNewsTools()],
    instructions="å°±è¯¥ä¸»é¢˜å†™ä¸€ä»½æŠ¥å‘Šã€‚åªè¾“å‡ºæŠ¥å‘Šã€‚",
    markdown=True,
)

# æŒ‡å®šç”¨æˆ·å’Œä¼šè¯
response = agent.run(
    "è¶‹åŠ¿åˆåˆ›å…¬å¸å’Œäº§å“ã€‚",
    user_id="user123",
    session_id="session123"
)
```

## ä¼ é€’å›¾åƒ/éŸ³é¢‘/è§†é¢‘/æ–‡ä»¶

æ‚¨å¯ä»¥å‘æ™ºèƒ½ä½“ä¼ é€’å¤šåª’ä½“å†…å®¹ï¼š

```python
from agno.agent import Agent
from agno.models.anthropic import Claude
from agno.storage.agent.sqlite import SqliteAgentStorage

agent = Agent(
    model=Claude(id="claude-sonnet-4-5"),
    tools=[HackerNewsTools()],
    instructions="å°±è¯¥ä¸»é¢˜å†™ä¸€ä»½æŠ¥å‘Šã€‚åªè¾“å‡ºæŠ¥å‘Šã€‚",
    markdown=True,
    storage=SqliteAgentStorage(table_name="agent_sessions"),
)

# ä¼ é€’å›¾åƒ
response = agent.run(
    "è¿™å¼ å›¾ç‰‡ä¸­æœ‰ä»€ä¹ˆï¼Ÿ",
    images=["path/to/image.jpg"]
)

# ä¼ é€’éŸ³é¢‘
response = agent.run(
    "è¿™æ®µéŸ³é¢‘ä¸­è¯´äº†ä»€ä¹ˆï¼Ÿ",
    audio=["path/to/audio.mp3"]
)

# ä¼ é€’è§†é¢‘
response = agent.run(
    "è¿™æ®µè§†é¢‘ä¸­å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ",
    video=["path/to/video.mp4"]
)

# ä¼ é€’æ–‡ä»¶
response = agent.run(
    "æ€»ç»“è¿™ä¸ªæ–‡æ¡£ã€‚",
    files=["path/to/document.pdf"]
)
```

## ä¼ é€’è¾“å‡ºæ¨¡å¼

æ‚¨å¯ä»¥æŒ‡å®šè¾“å‡ºæ¨¡å¼æ¥æ§åˆ¶æ™ºèƒ½ä½“çš„å“åº”æ ¼å¼ï¼š

```python
from agno.agent import Agent
from agno.models.anthropic import Claude
from agno.tools.hackernews import HackerNewsTools
from pydantic import BaseModel

class ReportOutput(BaseModel):
    title: str
    summary: str
    key_points: list[str]

agent = Agent(
    model=Claude(id="claude-sonnet-4-5"),
    tools=[HackerNewsTools()],
    instructions="å°±è¯¥ä¸»é¢˜å†™ä¸€ä»½æŠ¥å‘Šã€‚",
    output_model=ReportOutput,
)

response = agent.run("è¶‹åŠ¿åˆåˆ›å…¬å¸å’Œäº§å“ã€‚")

# è®¿é—®ç»“æ„åŒ–è¾“å‡º
print(response.output_model.title)
print(response.output_model.summary)
print(response.output_model.key_points)
```

## æš‚åœå’Œç»§ç»­è¿è¡Œ

æ‚¨å¯ä»¥æš‚åœå’Œç»§ç»­æ™ºèƒ½ä½“çš„è¿è¡Œï¼š

```python
from agno.agent import Agent
from agno.models.anthropic import Claude
from agno.tools.hackernews import HackerNewsTools

agent = Agent(
    model=Claude(id="claude-sonnet-4-5"),
    tools=[HackerNewsTools()],
    instructions="å°±è¯¥ä¸»é¢˜å†™ä¸€ä»½æŠ¥å‘Šã€‚åªè¾“å‡ºæŠ¥å‘Šã€‚",
    markdown=True,
)

# å¼€å§‹è¿è¡Œ
stream = agent.run("è¶‹åŠ¿åˆåˆ›å…¬å¸å’Œäº§å“ã€‚", stream=True)

# æš‚åœè¿è¡Œ
agent.pause_run(run_id="run123")

# ç»§ç»­è¿è¡Œ
agent.resume_run(run_id="run123")
```

## å–æ¶ˆè¿è¡Œ

æ‚¨å¯ä»¥å–æ¶ˆæ­£åœ¨è¿è¡Œçš„æ™ºèƒ½ä½“ï¼š

```python
from agno.agent import Agent
from agno.models.anthropic import Claude
from agno.tools.hackernews import HackerNewsTools

agent = Agent(
    model=Claude(id="claude-sonnet-4-5"),
    tools=[HackerNewsTools()],
    instructions="å°±è¯¥ä¸»é¢˜å†™ä¸€ä»½æŠ¥å‘Šã€‚åªè¾“å‡ºæŠ¥å‘Šã€‚",
    markdown=True,
)

# å¼€å§‹è¿è¡Œ
stream = agent.run("è¶‹åŠ¿åˆåˆ›å…¬å¸å’Œäº§å“ã€‚", stream=True)

# å–æ¶ˆè¿è¡Œ
agent.cancel_run(run_id="run123")
```

## å¼€å‘è€…èµ„æº

- æŸ¥çœ‹[æ™ºèƒ½ä½“æ¶æ„](/reference/agents/agent)
- æŸ¥çœ‹[è¿è¡Œå“åº”æ¶æ„](/reference/agents/run-response)
- æŸ¥çœ‹[å®è·µæŒ‡å—](https://github.com/agno-agi/agno/tree/main/cookbook/03_agents/README.md)