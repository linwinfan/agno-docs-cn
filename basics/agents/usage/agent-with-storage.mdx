---
title: å¸¦å­˜å‚¨çš„æ™ºèƒ½ä½“
sidebarTitle: å¸¦å­˜å‚¨çš„æ™ºèƒ½ä½“
description: å­¦ä¹ å¦‚ä½•åˆ›å»ºå¸¦æŒä¹…å­˜å‚¨çš„æ™ºèƒ½ä½“
mode: wide
---

æ­¤ç¤ºä¾‹å±•ç¤ºå¦‚ä½•åˆ›å»ºä¸€ä¸ª AI çƒ¹é¥ªåŠ©æ‰‹ï¼Œå°†ç²¾é€‰é£Ÿè°±æ•°æ®åº“çš„çŸ¥è¯†ä¸ç½‘ç»œæœç´¢åŠŸèƒ½å’ŒæŒä¹…å­˜å‚¨ç›¸ç»“åˆã€‚è¯¥æ™ºèƒ½ä½“ä½¿ç”¨æ­£å®—æ³°å¼é£Ÿè°±çš„ PDF çŸ¥è¯†åº“ï¼Œå¹¶å¯ä»¥åœ¨éœ€è¦æ—¶é€šè¿‡ç½‘ç»œæœç´¢è¡¥å……è¿™äº›ä¿¡æ¯ã€‚

å¯å°è¯•çš„ç¤ºä¾‹æç¤ºï¼š
- "å¦‚ä½•åˆ¶ä½œæ­£å®—çš„æ³°å¼ç‚’æ²³ç²‰ï¼Ÿ"
- "çº¢å’–å–±å’Œç»¿å’–å–±æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"
- "ä½ èƒ½è§£é‡Šä¸€ä¸‹é«˜è‰¯å§œæ˜¯ä»€ä¹ˆä»¥åŠå¯èƒ½çš„æ›¿ä»£å“å—ï¼Ÿ"
- "å‘Šè¯‰æˆ‘å†¬é˜´åŠŸæ±¤çš„å†å²"
- "æ³°å¼å¨æˆ¿å¿…å¤‡çš„é£Ÿææœ‰å“ªäº›ï¼Ÿ"
- "å¦‚ä½•åˆ¶ä½œæ³°å¼ç½—å‹’é¸¡ï¼ˆå¸•å…‹æ‹‰é²ï¼‰ï¼Ÿ"

<Steps>

  <Step title="åˆ›å»º Python æ–‡ä»¶">
    ```bash
    touch agent_with_storage.py
    ```
  </Step>


  <Step title="å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°æ‚¨çš„ Python æ–‡ä»¶ä¸­">
    ```python agent_with_storage.py
    from textwrap import dedent
    from typing import List, Optional

    import typer
    from agno.agent import Agent
    from agno.db.base import SessionType
    from agno.db.sqlite import SqliteDb
    from agno.knowledge.embedder.openai import OpenAIEmbedder
    from agno.knowledge.knowledge import Knowledge
    from agno.models.openai import OpenAIChat
    from agno.session import AgentSession
    from agno.tools.duckduckgo import DuckDuckGoTools
    from agno.vectordb.lancedb import LanceDb, SearchType
    from rich import print

    agent_knowledge = Knowledge(
        vector_db=LanceDb(
            uri="tmp/lancedb",
            table_name="recipe_knowledge",
            search_type=SearchType.hybrid,
            embedder=OpenAIEmbedder(id="text-embedding-3-small"),
        ),
    )

    # Add content to the knowledge
    agent_knowledge.add_content(
        url="https://agno-public.s3.amazonaws.com/recipes/ThaiRecipes.pdf"
    )

    # Setup the database
    db = SqliteDb(db_file="tmp/agents.db")


    def recipe_agent(user: str = "user"):
        session_id: Optional[str] = None

        # è¯¢é—®ç”¨æˆ·æ˜¯å¦è¦å¼€å§‹æ–°ä¼šè¯æˆ–ç»§ç»­ç°æœ‰ä¼šè¯
        new = typer.confirm("æ‚¨æƒ³è¦å¼€å§‹æ–°ä¼šè¯å—ï¼Ÿ")

        if not new:
            existing_sessions: List[AgentSession] = db.get_sessions(  # type: ignore
                user_id=user, session_type=SessionType.AGENT
            )
            if len(existing_sessions) > 0:
                session_id = existing_sessions[0].session_id

        agent = Agent(
            user_id=user,
            session_id=session_id,
            model=OpenAIChat(id="gpt-5-mini"),
            instructions=dedent("""\
                æ‚¨æ˜¯ä¸€ä½å……æ»¡çƒ­æƒ…ä¸”çŸ¥è¯†æ¸Šåšçš„æ³°å¼æ–™ç†ä¸“å®¶ï¼ğŸ§‘â€ğŸ³
                å°†è‡ªå·±è§†ä¸ºä¸€ä½æ¸©æš–é¼“åŠ±çš„çƒ¹é¥ªå¯¼å¸ˆã€
                æ³°å›½ç¾é£Ÿå†å²å­¦å®¶å’Œæ–‡åŒ–å¤§ä½¿çš„ç»“åˆä½“ã€‚

                å›ç­”é—®é¢˜æ—¶è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š
                1. é¦–å…ˆï¼Œåœ¨çŸ¥è¯†åº“ä¸­æœç´¢æ­£å®—çš„æ³°å¼é£Ÿè°±å’Œçƒ¹é¥ªä¿¡æ¯
                2. å¦‚æœçŸ¥è¯†åº“ä¸­çš„ä¿¡æ¯ä¸å®Œæ•´ï¼Œæˆ–è€…ç”¨æˆ·çš„é—®é¢˜æ›´é€‚åˆé€šè¿‡ç½‘ç»œæœç´¢ï¼Œè¯·è¿›è¡Œç½‘ç»œæœç´¢æ¥è¡¥å……ä¿¡æ¯
                3. å¦‚æœåœ¨çŸ¥è¯†åº“ä¸­æ‰¾åˆ°äº†ä¿¡æ¯ï¼Œåˆ™æ— éœ€è¿›è¡Œç½‘ç»œæœç´¢
                4. ä¸ºä¿è¯çœŸå®æ€§ï¼Œå§‹ç»ˆä¼˜å…ˆä½¿ç”¨çŸ¥è¯†åº“ä¿¡æ¯è€Œéç½‘ç»œæœç´¢ç»“æœ
                5. å¦‚æœ‰éœ€è¦ï¼Œå¯é€šè¿‡ç½‘ç»œæœç´¢è¡¥å……ä»¥ä¸‹ä¿¡æ¯ï¼š
                   - ç°ä»£æ”¹è‰¯ç‰ˆæœ¬æˆ–é£Ÿææ›¿ä»£å“
                   - æ–‡åŒ–èƒŒæ™¯å’Œå†å²æ¸Šæº
                   - é¢å¤–çš„çƒ¹é¥ªæŠ€å·§å’Œæ•…éšœæ’é™¤æ–¹æ³•

                æ²Ÿé€šé£æ ¼ï¼š
                1. æ¯ä¸ªå›å¤éƒ½ä»¥ç›¸å…³çš„çƒ¹é¥ªè¡¨æƒ…ç¬¦å·å¼€å¤´
                2. æ¸…æ™°åœ°ç»„ç»‡æ‚¨çš„å›å¤ç»“æ„ï¼š
                   - ç®€çŸ­çš„ä»‹ç»æˆ–èƒŒæ™¯è¯´æ˜
                   - ä¸»è¦å†…å®¹ï¼ˆé£Ÿè°±ã€è§£é‡Šæˆ–å†å²ï¼‰
                   - ä¸“ä¸šæŠ€å·§æˆ–æ–‡åŒ–è§è§£
                   - é¼“åŠ±æ€§çš„ç»“è®º
                3. å¯¹äºé£Ÿè°±ï¼Œåº”åŒ…å«ï¼š
                   - é£Ÿææ¸…å•åŠå¯èƒ½çš„æ›¿ä»£å“
                   - æ¸…æ™°çš„ç¼–å·çƒ¹é¥ªæ­¥éª¤
                   - æˆåŠŸç§˜è¯€å’Œå¸¸è§é™·é˜±æç¤º
                4. ä½¿ç”¨å‹å¥½ã€é¼“åŠ±æ€§çš„è¯­è¨€

                ç‰¹æ®ŠåŠŸèƒ½ï¼š
                - è§£é‡Šä¸ç†Ÿæ‚‰çš„æ³°å¼é£Ÿæå¹¶å»ºè®®æ›¿ä»£å“
                - åˆ†äº«ç›¸å…³çš„æ–‡åŒ–èƒŒæ™¯å’Œä¼ ç»Ÿ
                - æä¾›é€‚åº”ä¸åŒé¥®é£Ÿéœ€æ±‚çš„é£Ÿè°±è°ƒæ•´å»ºè®®
                - åŒ…å«æ­é…å»ºè®®å’Œé…èœæ¨è

                æ¯ä¸ªå›å¤éƒ½ä»¥ç§¯æå‘ä¸Šçš„ç»“æŸè¯­ç»“å°¾ï¼Œä¾‹å¦‚ï¼š
                - 'ç¥æ‚¨çƒ¹é¥ªæ„‰å¿«ï¼à¸‚à¸­à¹ƒà¸«à¹‰à¸­à¸£à¹ˆà¸­à¸¢ (äº«å—æ‚¨çš„ç¾é£Ÿ)ï¼'
                - 'æ„¿æ‚¨çš„æ³°å¼çƒ¹é¥ªä¹‹æ—…å¸¦æ¥å¿«ä¹ï¼'
                - 'äº«å—æ‚¨è‡ªåˆ¶çš„æ³°å¼ç››å®´ï¼'

                è¯·è®°ä½ï¼š
                - å§‹ç»ˆé€šè¿‡çŸ¥è¯†åº“éªŒè¯é£Ÿè°±çš„çœŸå®æ€§
                - æ˜ç¡®æŒ‡å‡ºå“ªäº›ä¿¡æ¯æ¥è‡ªç½‘ç»œæ¥æº
                - å¯¹æ‰€æœ‰æŠ€èƒ½æ°´å¹³çš„å®¶åº­å¨å¸ˆéƒ½è¦ç»™äºˆé¼“åŠ±å’Œæ”¯æŒ\
            """),
            db=db,
            knowledge=agent_knowledge,
            tools=[DuckDuckGoTools()],
            # To provide the agent with the chat history
            # We can either:
            # 1. Provide the agent with a tool to read the chat history
            # 2. Automatically add the chat history to the messages sent to the model
            #
            # 1. Provide the agent with a tool to read the chat history
            read_chat_history=True,
            # 2. Automatically add the chat history to the messages sent to the model
            # add_history_to_context=True,
            # Number of historical responses to add to the messages.
            # num_history_runs=3,
            markdown=True,
        )

        print("æ‚¨å³å°†ä¸æ™ºèƒ½ä½“èŠå¤©ï¼")
        if session_id is None:
            session_id = agent.session_id
            if session_id is not None:
                print(f"å·²å¼€å§‹ä¼šè¯ï¼š{session_id}\n")
            else:
                print("å·²å¼€å§‹ä¼šè¯\n")
        else:
            print(f"ç»§ç»­ä¼šè¯ï¼š{session_id}\n")

        # Runs the agent as a command line application
        agent.cli_app(markdown=True)


    if __name__ == "__main__":
        typer.run(recipe_agent)
    ```
  </Step>

  <Snippet file="create-venv-step.mdx" />

  <Step title="å®‰è£…åº“">
    ```bash
    pip install openai lancedb tantivy pypdf ddgs sqlalchemy typer rich agno
    ```
  </Step>

  <Step title="å¯¼å‡ºæ‚¨çš„ OpenAI API å¯†é’¥">

    <CodeGroup>

    ```bash Mac/Linux
      export OPENAI_API_KEY="your_openai_api_key_here"
    ```

    ```bash Windows
      $Env:OPENAI_API_KEY="your_openai_api_key_here"
    ```
    </CodeGroup>
  </Step>

  <Step title="è¿è¡Œæ™ºèƒ½ä½“">
    <CodeGroup>
    ```bash Mac
    python agent_with_storage.py
    ```

    ```bash Windows
    python agent_with_storage.py
    ```
    </CodeGroup>
  </Step>

</Steps>