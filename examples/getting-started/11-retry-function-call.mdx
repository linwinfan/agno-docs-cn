---
title: 重试函数调用
---

本示例展示如何在函数调用失败或您不喜欢输出时重试函数调用。这对于以下情况很有用：
- 处理临时故障
- 通过重试提高输出质量
- 实现人在环验证

## 代码

```python retry_function_call.py
from typing import Iterator

from agno.agent import Agent
from agno.exceptions import RetryAgentRun
from agno.tools import FunctionCall, tool

num_calls = 0


def pre_hook(fc: FunctionCall):
    global num_calls

    print(f"前置钩子：{fc.function.name}")
    print(f"参数：{fc.arguments}")
    num_calls += 1
    if num_calls < 2:
        raise RetryAgentRun(
            "这不够有趣，请使用不同的参数重试"
        )


@tool(pre_hook=pre_hook)
def print_something(something: str) -> Iterator[str]:
    print(something)
    yield f"我已经打印了 {something}"


agent = Agent(tools=[print_something], markdown=True)
agent.print_response("打印一些有趣的东西", stream=True)
```

## 使用方法

<Steps>
  <Snippet file="create-venv-step.mdx" />

  <Step title="安装库">
    ```bash
    pip install openai agno
    ```
  </Step>

  <Step title="运行智能体">
    ```bash
    python retry_function_call.py
    ```
  </Step>

</Steps>